<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Impression de produits {{ init.0.Produits }}  | Paositra malagasy</title>
        {% block stylesheets %}
            {{ encore_entry_link_tags('app') }}
        {% endblock %}
        <style>
            table,tr,th,td {
                    border: 2px solid black;
                }
            }
        </style>
    </head>
    <body onload="window.print()">
            <table class="table" data-toggle="table" border="1">
            <h3 class="text-danger">Etat de stock produit : {{ init.0.Produits }}  </h3>
                <thead>
                    <tr>
                        <th> Ordre</th>
                        <th> Categorie </th>
                        <th>Valeur Faciales</th>
                        <th>Stock initial</th>
                        <th>Entr√©e</th>
                        <th>Sortie</th>
                        <th>Stock Acteul </th>
                    </tr>
                </thead>
                <tbody id="table">
                    {% set sumValueInit = 0 %}
                    {% set sumValueEnter = 0 %}
                    {% set sumValueOut = 0 %}
                    {% set sumValueCurrent = 0 %}
                    {% set valeur = 0 %}
                    {% for key,value in courant %}
                        <tr>
                            {% for key2, value2 in value %} 
                                
                                {% if key2 =='ordre' %}
                                    <td> {{ value2 }}  </td>
                                {% elseif key2 =='NomDeCategorie' %}
                                    <td> {{ value2 }} </td>  
                                {% elseif key2 =='produit' %}
                                    <td> {{ value2 }} </td>
                                {% elseif key2 =='valeurFaciale' %}
                                    <td> {{ value2 }} </td>
                                {% elseif key2 =='initiale' %}
                                    {% set valeur = initial[key][0] %}
                                    <td> {{ valeur }} </td>
                                    {% set sumValueInit = sumValueInit + valeur %} 
                                {% elseif key2 =='entrer' %}
                                    {% set valeur = entrer[key][0] - initial[key][0] %}
                                    <td> {{ valeur }} </td> 
                                    {% set sumValueEnter = sumValueEnter + valeur %}
                                {% elseif key2 =='sortie' %}
                                    {% if out is empty %}
                                        {% set valeur = 0 %}
                                        <td> {{ valeur }} </td> 
                                        {% set sumValueOut = sumValueOut + valeur %}
                                    {% else %}
                                        {% set valeur = out[key][0]|abs %}
                                        {% set sumValueOut = sumValueOut + valeur %}
                                        <td> {{ valeur }} </td>
                                    {% endif %} 
                                {% elseif key2 =='actuelle' %}
                                    {% set valeur = value2 %}
                                    {% set sumValueCurrent = sumValueCurrent + valeur %}
                                    <td> {{ valeur }} </td>                                                                                                                   
                                {% endif %}
                            {% endfor %}
                        </tr>
                    {% endfor %}
                        <tr>
                            {% set valeur = 0 %}
                            {% if issubmitted == true %}
                                <th colspan="3" class="text-right pr-3"> Total (nombre)</th>
                            {% else %}
                            <th colspan="4" class="text-right pr-3"> Total (nombre)</th>
                            {% endif %}
                            {% for key, value in total %}
                                {% if key == "initiale"  %}
                                    {% set valeur = sumValueInit %}
                                    <th>  {{ valeur }} </th>
                                {% elseif key == "entrer" %}
                                    <th> {{ sumValueEnter }} </th>
                                {% elseif key == "sortie"%} 
                                    <th>{{ sumValueOut }} </th>
                                {% elseif key == "actuelle" %}                                                                            
                                    <th> {{ sumValueCurrent }} </th>
                                {% endif %}
                            {% endfor %}
                        </tr>
                    </tbody>
            </table>
            <div class="d-flex flex-row-reverse bd-highlight">
                <div class="p-2 bd-highlight">
                    <p> Antananarivo le ,{{ 'now' |format_date(locale='fr') }} </p>
                    <p><span> Chef de  Centre d'Approvisionnement en Valeurs Postales </span></p>
                </div>
            </div>
    </body>
</html>